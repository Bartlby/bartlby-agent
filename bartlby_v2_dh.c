#include <stddef.h>
#include <openssl/dh.h>

 DH *get_dh512(void)
{
    static unsigned char dhp_512[] = {
        0x91, 0x40, 0x5A, 0x0D, 0x15, 0x7A, 0xE7, 0x38, 0xB3, 0xD4,
        0xCE, 0xE1, 0x20, 0x57, 0x34, 0x70, 0xC5, 0xFB, 0xE9, 0x05,
        0x49, 0x93, 0x18, 0xBC, 0x2B, 0xA1, 0x71, 0x27, 0x02, 0x98,
        0x29, 0xCC, 0xDD, 0xCE, 0x87, 0x95, 0x5D, 0xCB, 0x6E, 0x18,
        0xEB, 0xA2, 0x3A, 0xEB, 0xB4, 0xAD, 0x6D, 0x3A, 0xA1, 0x56,
        0xDC, 0x21, 0xCE, 0x71, 0x52, 0x30, 0x83, 0xF9, 0xB5, 0x26,
        0x20, 0xB3, 0x26, 0xDB
    };
    static unsigned char dhg_512[] = {
        0x02
    };
    DH *dh = DH_new();
    BIGNUM *p, *g;

    if (dh == NULL)
        return NULL;
    p = BN_bin2bn(dhp_512, sizeof(dhp_512), NULL);
    g = BN_bin2bn(dhg_512, sizeof(dhg_512), NULL);
    if (p == NULL || g == NULL
            || !DH_set0_pqg(dh, p, NULL, g)) {
        DH_free(dh);
        BN_free(p);
        BN_free(g);
        return NULL;
    }
    return dh;
}
